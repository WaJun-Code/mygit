多因子选股：
    1.风险源分析（风险源的因素分析是因子构架的基础）
    2.因子筛选及体系构建【投资者可以优选出解释能力强的因子（此处根据个人分析及风险分析作出个人决策）】
    3.模拟实证回测

EPS、BPS对Close有很直接影响，但是其它指标无很直观影响，且对于Target均无明显影响

自回归拟合第二天Close、基本面因子非序列回归拟合第二天Close、涨跌指标拟合target
若单独看每天2000支股票对比，则财务和市场数据的关联程度均很低，所以要利用只能在时间序列上，对每支股票看财务和市场信息的影响。

A股'Prime Market (First Section)'1711支、三板'Growth Market (Mothers/JASDAQ)'199支、B股'Standard Market (Second Section)'90支
SENet、ECAnet、softattention
粗筛伪代码：（或写一个树模型来筛，指标用["C_target"].shift(-1)）
    ①用总资产选出大盘股150支
    ②B股全丢
    ③【用总市值增长率】判断行业是否景气，暴跌则全部做空，暴涨则全部买入，中庸则通过【销售毛利率、净资产收益率】筛出行业里前30%、后30%
    把4000+支股票全部参与粗筛，最后去重一下，约能筛出600支左右。
精排伪代码：
    ①仅用price表做各种因子，然后接树模型【用窗口2的时序滑窗】
    ②考虑移植到NN
写相应submit脚本
    ①把valid_fin的数据按'CurrentPeriodEndDate'排序，然后按'Equity'来dropna，接着按SecuritiesCode去重保留 last 即可，然后做成【SecuritiesCode，Date】格式，得到两个SecuritiesCode【写为一个返回两个 list 的函数】
    ②通过valid_xy.apply筛出两个df
    ③然后分别对两个df作用model得到前后200支的rank


【唯一靠谱的就是用财务信息来选出潜力股+大盘上升股，里面挑前200条，然后剩下的里面挑后200条】市场信息
    1.市值大小CMV筛前后50%，账面市值比BM、盈利因子RMW=息税前利润'Profit'/股东权益'Equity'、投资水平CMA=当期新增总资产'TotalAssets'/前一期的总资产'TotalAssets' 取前30%、中间、后30%
    2.大盘股'Equity'选150，【销售毛利率、资产回报率='Profit'/"TotalAssets"、市场份额、销售增长率、】
    3.找出超过行业【销售毛利率、净资产收益率】平均水平的股票

先只用price里的数据做动量因子
    对序列进行自回归验证

然后再通过fin、trades、stocklist做基本面分析相关的因子

1.2000支股票如何做embedding
2.做成2000支股票的learning2rank
    看财报发布附近日期有无很大变化
    把Date拎出来看各个公司财务信息影响
    对各个动量因子进行肢解

公司市值=已发行股票数*股票单价(Close)
息税前利润（EBIT）=净利润+所得税+利息
股东权益（即净资产'Equity'）=资产总额-负债总额（债券）
市值与总资产无直接关系
股息是指股份公司从提取了公积金、公益金的税后利润中按照股息率派发给股东的收益。红利虽然也是公司分配给股东的回报，但它与股息的区别在于，股息的利率是固定的（特别是对优先股而言），而红利数额通常是不确定的，它随着公司每年可分配盈余的多少而上下浮动。因此，有人把普通股的收益称为红利，而股息则专指优先股的收益。红利则是在上市公司分派股息之后按持股比例向股东分配的剩余利润。获取股息和红利，是股民投资于上市公司的基本目的，也是股民的基本经济权利。股息与红利合称为股利。
库存股股票既不分配股利，又不附投票权。在公司的资产负债表上，库存股不能列为公司资产，而是以负数形式列为一项股东权益（Shareholder's Equity）
1一级市场，购买新股和配股以及增发的股票的钱是流入了上市公司，2二级市场，在交易市场上买入的已经流通的股票的钱是在股民（包括机构，基金）之间流转，没有进入上市公司

PE、PB、PS：3以上越小越好，过大则说明股权泡沫比较严重；3以下则是越大越被看好


各因子调研：
    K线、ACD、MACD、KDJ、ASI、AR、BR、High52、PVT、OBV、CVI、ADTM、CCI、ATR、CR、MassIndex、Boll、Elder、BBI、MA、EMA、TEMA、DBCD、MFI、MTM、Ulcer、DHILO、EMV、RVI、ChaikinOscillator、ChaikinVolatility、UOS、DMI、ARBR、PSY、WVAD、ROC、
    ARC、APBMA、MA10Close、SRMI、CMO、REVS、REVS5M、FiftyTwoWeekHigh、Price1M、RC、DDI、TRIX、Aroon、Volumn1M、Volumn3M、VEMA、VMACD、VOSC、VR、VROC、VSTD、MoneyFlow20、Variance
    
    市场因子【市场风险、波动性（方差之类的）、Beta系数、流动性、换手率】流动性好的股票换手率也就高，所以流动性差的股票多是小盘股或高度控盘的股票，是不适合大资金运作的，即便买完之后股价涨上去了，但卖不掉，对于大资金风险更大，所以他们更愿意在流动性很好的大盘股里运作，那里交投活跃，大量买卖也不会引起股价明显变动。不过中小投资者就自由很多了，由于资金量少，可以有很多选择。一个流动市场的特点是市场上在任何时刻都有买家和卖家。另一个流动性的定义是，下一次贸易的价格与上一次贸易的价格相等的可能性。假如一个市场上有许多买家和卖家的话，那么这个市场的流动性就非常高。这样的市场被称为深市场。
    风格因子【价值因子：账面市值比BM、PE、PB、PS、PEG、EV/EBIDTA 等；成长因子：账面市值比、EPS 增长、营业利润增长、净利润增长、总利润增长等；规模因子：总市值、流通市值、总股本、流通股本等。】
        账面市值比(BM)=股东权益'Equity'/公司市值=(每股净资产x流通股数)/(流通股数x每股股价)=每股净资产BPS/每股股价Close=B/P=市净率的倒数
        PE市盈率＝普通股每股市场价格Close÷普通股每年每股盈利EPS=总市值/净利润
        PB市净率=股票价格Close/账面价值BPS=总市值/净资产
        PS市销率=股票价格Close/每股销售收入('NetSales'/'AverageNumberOfShares')=总市值/销售收入
        PEG=PE/（企业年盈利增长率*100）
        公司价值EV=市值+总负债-总现金=市值+净负债。。。。EBIT=经营利润+投资收益+营业外收入－营业外支出+以前年度损益调整(或=净利润+所得税+利息）。。。。。。+折旧费用+摊销费用DA
        EV/EBITDA 又称企业价值倍数，是一种被广泛使用的公司估值指标，公式为，EV÷EBITDA 投资应用：EV/EBITDA和市盈率（PE）等相对估值法指标的用法一样，其倍数相对于行业平均水平或历史水平较高通常说明高估，较低说明低估，不同行业或板块有不同的估值（倍数）水平。
        
        EPS增长=(本期净利润/本期总股本-上年同期净利润/上年同期总股本)/ABS(上年同期净利润/上年同期总股本)*100%
        营业利润增长率=（本年营业利润—上年营业利润）/上年营业利润*100%。
        净利润=利润总额－所得税
        净利润增长率=(当期净利润-上期净利润)/上期净利润*100%
        净利润增长额=净利润-上年净利润
        净利润增长率=（净利润增长额÷上年净利润）×100%
        总利润增长同上
        
        流通市值指在某特定时间内当时可交易的流通股股数乘以当时股价得出的流通股票总价值。 资产负债（L/A)、固定资产比例（FAP）、流通市值（CMV）
        总  股本=股票面值*股份总额   同理于流通股本
        
    财务因子【常用财务因子：EPS、BPS每股净资产、PE、PB、PS、动态市盈（PEG） 等；盈利能力因子：ROE、ROA、主营毛利率（GP/R)、净利率(P/R)、ROIC 等；偿债能力因子：流动比率、速动比率等；现金流量因子：销售商品提供劳务收到的现金/营业收入、资本支出/折旧和摊销等。】
        EPS每股收益=盈余'Profit'/流通在外股数
        BPS每股净资产= 股东权益'Equity' / 总股数 (注意！！表里缺失严重，需要计算填充BookValuePerShare = Equity/AverageNumberOfShares)
        由此可得各个季度的股票数'AverageNumberOfShares'
        
        ROE净资产收益率=报告期净利润/报告期末净资产
        ROA总资产净回报率=净利润÷资产平均余额，其中资产平均余额＝(期初资产总计＋期末资产总计)÷2。
        1.不含税售价=含税售价/(1+增值税率)=990/(1+10%)=900元、2.毛利率=（不含税售价－不含税进价）/不含税售价×100%
        ROIC=NOPLAT(息前税后经营利润)/IC(投入资本)、NOPLAT=EBIT×(1－T)、IC=有息负债+净资产－超额现金－非经营性资产【NOPLAT = EBIT ×(1-所得税率)= EBIT - 所得税(只考虑核心业务,扣除非经常性损益)；NOPLAT=（税后）利润合计（来自利润表）+税后利息费用（非财务费用）-（税后）非经常性损益】
        
        Liquidity Ratio流动资产比率=流动资产/ 流动负债*100%
        现金比率=（货币资金+现金等价物）/流动负债
        速动比率=速动资产/流动负债，其中速动资产=流动资产-存货-预付账款-待摊费用
